<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NGen: LSTM Model</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NGen
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_doc__l_s_t_m__m_o_d_e_l.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">LSTM Model </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><ul>
<li><a href="#summary">Summary</a></li>
<li><a href="#formulation-config">Formulation Config</a><ul>
<li><a href="#required-parameters">Required Parameters</a></li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md97"></a>
Summary</h1>
<p>A long short-term memory (LSTM) model and corresponding realization is included in the ngen framework. The model is not included in the default ngen build because it requires the LibTorch library in order to compile and run, and this is not a basic required library for ngen.</p>
<p>The basic outline of steps needed to run the LSTM model is:</p><ul>
<li><a href="https://pytorch.org/docs/stable/cpp_index.html">Install the LibTorch library version 1.8 or later.</a></li>
<li><p class="startli">Create the build directory including the option to activate the lstm:</p>
<p class="startli"><code>cmake -DCMAKE_BUILD_TYPE=Debug -B cmake-build-debug -DLSTM_TORCH_LIB_ACTIVE:BOOL=ON -S .</code> <br  />
</p>
</li>
<li><p class="startli">Unit tests for the LSTM model and realization can then be built and run from the main directory with the following two commands:</p>
<p class="startli"><code>cmake --build cmake-build-debug --target test_lstm</code> <br  />
</p>
<p class="startli"><code>./cmake-build-debug/test/test_lstm</code> <br  />
</p>
</li>
<li>The formulation config and required parameters to run the LSTM for a given catchment are below.</li>
</ul>
<h1><a class="anchor" id="autotoc_md98"></a>
Formulation Config</h1>
<p>An <a href="https://github.com/NOAA-OWP/ngen/tree/master/data/lstm/example_lstm_realization_config.json">example realization.</a> This example realziation can be run with the following command from the main ngen directory: <br  />
</p>
<p><code>cmake-build-debug/ngen ./data/catchment_data.geojson "cat-67" ./data/nexus_data.geojson "nex-68" ./data/lstm/example_lstm_realization_config.json</code></p>
<h2><a class="anchor" id="autotoc_md99"></a>
Required Parameters</h2>
<p>The following must be present in the formulation/realization JSON config for a catchment entry using the LSTM formulation type:</p><ul>
<li><code>pytorch_model_path</code><ul>
<li>String name with path of a trained LSTM PyTorch model</li>
</ul>
</li>
<li><code>normalization_path</code><ul>
<li>String name with path of a CSV file containing normalization parameters to the inputs of the LSTM model</li>
</ul>
</li>
<li><code>initial_state_path</code><ul>
<li>String name with path of a CSV file containing the initial states of the LSTM model</li>
<li>The model currently requires an initial state though the code could be updated to not require one</li>
</ul>
</li>
<li><code>latitude</code><ul>
<li>Double holding the catchment latitude</li>
</ul>
</li>
<li><code>longitude</code><ul>
<li>Double holding the catchment longitude</li>
</ul>
</li>
<li><code>area_square_km</code><ul>
<li>Double holding the catchment area in sqaure km</li>
</ul>
</li>
<li><code>useGPU</code><ul>
<li>Boolean giving option to load and run and model on a GPU </li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Aug 27 2021 18:56:35 for NGen by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
